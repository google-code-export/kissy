<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>dom-offset Test</title>
<style>
        /*
            html { margin: 3px; border: 4px solid #eee; padding: 5px; }
            body { margin: 6px; border: 7px solid #ccc; padding: 8px; }
            */
    /*只保证以下设置正常*/
    html, body {
        margin: 0;
        padding: 0;
        border: none;
    }
</style>
</head>
<body>
<script src="../test/test.js"></script>
<script>
    KISSY.Test.Config.times = 1;
    document.body.className = ''; // remove attached cls
</script>

<h2>Test Data</h2>

<script src="../kissy/kissy.js"></script>
<script src="../kissy/kissy-lang.js"></script>
<script src="../kissy/kissy-ua.js"></script>

<script src="dom.js"></script>
<script src="selector.js"></script>
<script src="dom-class.js"></script>
<script src="dom-attr.js"></script>
<script src="dom-style.js"></script>
<script src="dom-style-ie.js"></script>
<script src="dom-offset.js"></script>

<script src="../../third-party/jquery/jquery-1.4.2.js"></script>
<script src="../../third-party/ext-core/ext-core.js"></script>

<div style="height:100px;width:100px;padding:20px;border:1px solid black;position:relative;">
    <div id="testStatic" style="border:1px solid red;">static test</div>

    <div style="position:absolute;border:1px solid green;margin:5px;" id="testAbsolute">
        absolute test
    </div>
</div>

<iframe src="test-iframe-offset.html"
        id="test_iframe"
        style="border:1px solid black;position:absolute;top:100px;left:500px;background:white;"
        width="200"
        height="200"
        frameborder="0"
        scrolling="no"
        ></iframe>

<!-- Test Cases -->
<script>
    var S = KISSY, DOM = S.DOM, UA = S.UA, ExtDOM = Ext.lib.Dom;

    function test_offset(test) {

        //        test.echo('docElem.clientLeft = ' + document.documentElement.clientLeft);
        //        test.echo('docElem.offsetLeft = ' + document.documentElement.offsetLeft);
        //        test.echo('body.clientLeft = ' + document.body.clientLeft);
        //        test.echo('body.offsetLeft = ' + document.body.offsetLeft);
        //        test.echo('box.offsetLeft = ' + S.get('#konsole').offsetLeft);
        //        test.echo('scrollLeft = ' + DOM.scrollLeft());
        //        test.echo('box.left = ' + S.get('#konsole').getBoundingClientRect().left);
        //        test.echo('jQuery offset.left = ' + jQuery('#konsole').offset().left);
        //        test.echo('KISSY offset.left = ' + DOM.offset('#konsole').left);

        var t = S.get("#testAbsolute"),
                t2 = S.get('#testStatic'),
                before = DOM.offset('#testAbsolute').left,
                iframe_t3 = S.get("#test_iframe").contentWindow.document.getElementById("test_inner");
        //指定值
        DOM.offset(t2, { left: 5 });
        if (DOM.offset(t2).left != 5) test.fail();
        //原地设置
        DOM.offset(t, { left: before });
        if (DOM.offset(t).left != before) test.fail();

        //iframe内元素整体坐标测试
        if (DOM.offset(iframe_t3, document).top != 200) test.fail();
        if (DOM.offset(iframe_t3, document).left != 550) test.fail();

    }

    function test_scrollLeft(test) {
        if (DOM.scrollLeft() !== 0) test.fail();
    }

    function test_scrollTop(test) {
        if (DOM.scrollTop() !== 0) test.fail();
    }

    function test_docHeight(test) {
        if (DOM.docHeight() !== ExtDOM.getDocumentHeight()) test.fail();
    }

    function test_docWidth(test) {
        if (DOM.docWidth() !== ExtDOM.getDocumentWidth()) test.fail();
    }

    function test_viewportHeight(test) {
        if (DOM.viewportHeight() !== ExtDOM.getViewportHeight()) test.fail();
    }

    function test_viewportWidth(test) {
        if (DOM.viewportWidth() !== ExtDOM.getViewportWidth()) test.fail();
    }

</script>

</body>
</html>