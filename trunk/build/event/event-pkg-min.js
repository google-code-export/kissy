/*
Copyright 2010, KISSY UI Library v1.0.5
MIT Licensed
build: 669 May 22 23:47
*/
KISSY.add("event",function(d,j){function k(a,b,e,g){if(d.isString(b))b=d.query(b);if(d.isArray(b)){d.each(b,function(h){p[a](h,e,g)});return true}if((e=d.trim(e))&&e.indexOf(v)>0){d.each(e.split(v),function(h){p[a](b,h,g)});return true}}function i(a){var b=-1;if(a.nodeType===3||a.nodeType===8)return b;return b=a.nodeType?f.attr(a,s):a.isCustomEventTarget?a.eventTargetId:a[s]}function l(a,b){if(a.nodeType===3||a.nodeType===8)return d.error("Text or comment node is not valid event target.");if(a.nodeType)f.attr(a,
s,b);else if(a.isCustomEventTarget)a.eventTargetId=b;else try{a[s]=b}catch(e){d.error(e)}}function c(a){if(a.nodeType)f.removeAttr(a,s);else if(a.isCustomEventTarget)a.eventTargetId=j;else a[s]=j}var f=d.DOM,o=window,w=document,x=w.addEventListener?function(a,b,e){a.addEventListener&&a.addEventListener(b,e,false)}:function(a,b,e){a.attachEvent&&a.attachEvent("on"+b,e)},y=w.removeEventListener?function(a,b,e){a.removeEventListener&&a.removeEventListener(b,e,false)}:function(a,b,e){a.detachEvent&&a.detachEvent("on"+
b,e)},s="data-ks-event-guid",v=" ",z=d.now(),q={},p={special:{},add:function(a,b,e){if(!k("add",a,b,e)){var g=i(a),h,n;if(!(g===-1||!b||!d.isFunction(e))){if(!g){l(a,g=z++);q[g]={target:a,events:{}}}n=q[g].events;h=!a.isCustomEventTarget&&p.special[b]||{};if(!n[b]){g=function(m,r){if(!m||!m.fixed){m=new d.EventObject(a,m,b);d.isPlainObject(r)&&d.mix(m,r)}h.setup&&h.setup(m);return(h.handle||p._handle)(a,m,n[b].listeners)};n[b]={handle:g,listeners:[]};if(a.isCustomEventTarget)a._addEvent&&a._addEvent(b,
g);else x(a,h.fix||b,g)}n[b].listeners.push(e)}}},remove:function(a,b,e){if(!k("remove",a,b,e)){var g=i(a),h,n,m,r,t,u;if(g!==-1)if(g&&(h=q[g]))if(h.target===a){h=h.events||{};if(n=h[b]){m=n.listeners;t=m.length;if(d.isFunction(e)&&t&&d.inArray(e,m)){u=[];for(r=0;r<t;++r)e!==m[r]&&u.push(m[r]);t=u.length}if(e===j||t===0){a.isCustomEventTarget||y(a,b,n.handle);delete q[g].type}}if(b===j||d.isEmptyObject(h)){for(b in h)p.remove(a,b);delete q[g];c(a)}}}},_handle:function(a,b,e){for(var g,h=0,n=e.length;h<
n;++h){g=e[h].call(a,b);if(b.isImmediatePropagationStopped)break;g===false&&b.halt()}return g},_getCache:function(a){return q[a]},_simpleAdd:x,_simpleRemove:y};p.on=p.add;d.Event=p;o.attachEvent&&!o.addEventListener&&o.attachEvent("onunload",function(){var a,b;for(a in q)if(b=q[a].target)try{p.remove(b)}catch(e){}})});
KISSY.add("event-object",function(d,j){function k(c,f,o){this.currentTarget=c;this.originalEvent=f||{};if(f){this.type=f.type;this._fix()}else{this.type=o;this.target=c}this.fixed=true}var i=document,l="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
d.mix(k.prototype,{_fix:function(){for(var c=this.originalEvent,f=l.length,o;f;){o=l[--f];this[o]=c[o]}if(!this.target)this.target=this.srcElement||i;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===j&&this.clientX!==j){c=i.documentElement;f=i.body;this.pageX=this.clientX+(c&&c.scrollLeft||f&&f.scrollLeft||0)-(c&&c.clientLeft||f&&f.clientLeft||0);
this.pageY=this.clientY+(c&&c.scrollTop||f&&f.scrollTop||0)-(c&&c.clientTop||f&&f.clientTop||0)}if(this.which===j)this.which=this.charCode!==j?this.charCode:this.keyCode;if(this.metaKey===j)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==j)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var c=this.originalEvent;if(c.preventDefault)c.preventDefault();else c.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var c=this.originalEvent;
if(c.stopPropagation)c.stopPropagation();else c.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var c=this.originalEvent;c.stopImmediatePropagation?c.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(c){c?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});d.EventObject=k});
KISSY.add("event-target",function(d,j){var k=d.Event;d.EventTarget={eventTargetId:j,isCustomEventTarget:true,fire:function(i,l){if((i=((k._getCache(this.eventTargetId||-1)||{}).events||{})[i])&&d.isFunction(i.handle))return i.handle(j,l)},on:function(i,l){k.add(this,i,l)},detach:function(i,l){k.remove(this,i,l)}}});
KISSY.add("event-mouseenter",function(d){var j=d.Event;d.UA.ie||d.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(k){j.special[k.name]={fix:k.fix,setup:function(i){i.type=k.name},handle:function(i,l,c){var f=l.relatedTarget;try{for(;f&&f!==i;)f=f.parentNode;f!==i&&j._handle(i,l,c)}catch(o){}}}})});
