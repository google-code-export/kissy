/*
Copyright 2010, KISSY UI Library v1.0.5
MIT Licensed
build: 521 Apr 5 12:27
*/
KISSY.add("switchable",function(d,g){function k(a,b){b=b||{};if(!("mackupType"in b))if(b.panelCls)b.mackupType=1;else if(b.panels)b.mackupType=2;b=d.merge(k.Config,b);this.container=d.get(a);this.config=b;this.triggers=this.triggers||[];this.panels=this.panels||[];if(this.activeIndex===g)this.activeIndex=b.activeIndex;this._init()}var n=YAHOO.util,c=n.Dom,h=n.Event,i=YAHOO.lang,q=document;k.Config={mackupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",
panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,activeTriggerCls:"active",steps:1,viewSize:[]};k.Plugins=[];d.mix(k.prototype,{_init:function(){var a=this,b=a.config;a.panels.length===0&&a._parseMackup();a.createEvent("beforeSwitch");a.createEvent("onSwitch");b.hasTriggers&&a._bindTriggers();d.each(k.Plugins,function(f){f.init&&f.init(a)})},_parseMackup:function(){var a=this.container,b=this.config,f=b.hasTriggers,l,j=[],p=[];switch(b.mackupType){case 0:if(l=
d.get("."+b.navCls,a))j=c.getChildren(l);l=d.get("."+b.contentCls,a);p=c.getChildren(l);break;case 1:j=d.query("."+b.triggerCls,a);p=d.query("."+b.panelCls,a);break;case 2:j=b.triggers;p=b.panels;break}a=p.length;this.length=a/b.steps;if(f&&a>0&&j.length===0)j=this._generateTriggersMackup(this.length);if(f){b=0;for(f=j.length;b<f;b++)this.triggers.push(j[b])}for(b=0;b<a;b++)this.panels.push(p[b]);this.content=l||p[0].parentNode},_generateTriggersMackup:function(a){var b=this.config,f=q.createElement("UL"),
l,j;f.className=b.navCls;for(j=0;j<a;j++){l=q.createElement("LI");if(j===this.activeIndex)l.className=b.activeTriggerCls;l.innerHTML=j+1;f.appendChild(l)}this.container.appendChild(f);return c.getChildren(f)},_bindTriggers:function(){var a=this,b=a.config,f=a.triggers,l,j,p=f.length;for(j=0;j<p;j++)(function(e){l=f[e];h.on(l,"click",function(){a._onFocusTrigger(e)});h.on(l,"focus",function(){a._onFocusTrigger(e)});if(b.triggerType==="mouse"){h.on(l,"mouseenter",function(){a._onMouseEnterTrigger(e)});
h.on(l,"mouseleave",function(){a._onMouseLeaveTrigger(e)})}})(j)},_onFocusTrigger:function(a){if(this.activeIndex!==a){this.switchTimer&&this.switchTimer.cancel();this.switchTo(a)}},_onMouseEnterTrigger:function(a){var b=this;if(b.activeIndex!==a)b.switchTimer=i.later(b.config.delay*1E3,b,function(){b.switchTo(a)})},_onMouseLeaveTrigger:function(){this.switchTimer&&this.switchTimer.cancel()},switchTo:function(a,b){var f=this.config,l=this.triggers,j=this.panels,p=this.activeIndex,e=f.steps,o=p*e,
r=a*e;if(a===p)return this;if(!this.fireEvent("beforeSwitch",a))return this;if(f.hasTriggers)this._switchTrigger(p>-1?l[p]:null,l[a]);if(b===g)b=a>p?"forward":"forward";this._switchView(j.slice(o,o+e),j.slice(r,r+e),a,b);this.activeIndex=a;return this},_switchTrigger:function(a,b){var f=this.config.activeTriggerCls;a&&c.removeClass(a,f);c.addClass(b,f)},_switchView:function(a,b,f){c.setStyle(a,"display","none");c.setStyle(b,"display","block");this.fireEvent("onSwitch",f)},prev:function(){var a=this.activeIndex;
this.switchTo(a>0?a-1:this.length-1,"backward")},next:function(){var a=this.activeIndex;this.switchTo(a<this.length-1?a+1:0,"forward")}});d.augment(k,n.EventProvider);d.Switchable=k});
KISSY.add("switchable-autoplay",function(d){var g=YAHOO.util.Event,k=YAHOO.lang,n=d.Switchable;d.mix(n.Config,{autoplay:false,interval:5,pauseOnHover:true});n.Plugins.push({name:"autoplay",init:function(c){var h=c.config;if(h.autoplay){if(h.pauseOnHover){g.on(c.container,"mouseenter",function(){c.paused=true});g.on(c.container,"mouseleave",function(){setTimeout(function(){c.paused=false},h.interval*1E3)})}c.autoplayTimer=k.later(h.interval*1E3,c,function(){c.paused||c.switchTo(c.activeIndex<c.length-
1?c.activeIndex+1:0)},null,true)}}})});
KISSY.add("switchable-effect",function(d){var g=YAHOO.util,k=g.Dom,n=d.Switchable,c;d.mix(n.Config,{effect:"none",duration:0.5,easing:g.Easing.easeNone});n.Effects={none:function(h,i,q){k.setStyle(h,"display","none");k.setStyle(i,"display","block");q()},fade:function(h,i,q){if(h.length!==1)throw new Error("fade effect only supports steps == 1.");var a=this,b=a.config,f=h[0],l=i[0];a.anim&&a.anim.stop();k.setStyle(l,"opacity",1);a.anim=new g.Anim(f,{opacity:{to:0}},b.duration,b.easing);a.anim.onComplete.subscribe(function(){a.anim=
null;k.setStyle(l,"z-index",9);k.setStyle(f,"z-index",1);q()});a.anim.animate()},scroll:function(h,i,q,a){var b=this;h=b.config;i=h.effect==="scrollx";var f={};f[i?"left":"top"]={to:-(b.viewSize[i?0:1]*a)};b.anim&&b.anim.stop();b.anim=new g.Anim(b.content,f,h.duration,h.easing);b.anim.onComplete.subscribe(function(){b.anim=null;q()});b.anim.animate()}};c=n.Effects;c.scrollx=c.scrolly=c.scroll;n.Plugins.push({name:"effect",init:function(h){var i=h.config,q=i.effect,a=h.panels,b=i.steps,f=h.activeIndex*
b,l=f+b-1,j=a.length;h.viewSize=[i.viewSize[0]||a[0].offsetWidth*b,i.viewSize[0]||a[0].offsetHeight*b];if(q!=="none"){for(i=0;i<j;i++)a[i].style.display="block";switch(q){case "scrollx":case "scrolly":h.content.style.position="absolute";h.content.parentNode.style.position="relative";if(q==="scrollx"){k.setStyle(a,"float","left");h.content.style.width=h.viewSize[0]*(j/b)+"px"}break;case "fade":for(i=0;i<j;i++){k.setStyle(a[i],"opacity",i>=f&&i<=l?1:0);a[i].style.position="absolute";a[i].style.zIndex=
i>=f&&i<=l?9:1}break}}}});d.mix(n.prototype,{_switchView:function(h,i,q,a){var b=this,f=b.config.effect;(typeof f==="function"?f:c[f]).call(b,h,i,function(){b.fireEvent("onSwitch",q)},q,a)}})});
KISSY.add("switchable-circular",function(d){function g(e,o,r,s,u){var m=this;e=m.config;o=m.length;var v=m.activeIndex,t=e.scrollType===j,w=t?i:q,x=m.viewSize[t?0:1];t=-x*s;var z={},A,y=u===l;if(A=y&&v===0&&s===o-1||u===f&&v===o-1&&s===0)t=k.call(m,m.panels,s,y,w,x);z[w]={to:t};m.anim&&m.anim.stop();m.anim=new c.Anim(m.content,z,e.duration,e.easing);m.anim.onComplete.subscribe(function(){A&&n.call(m,m.panels,s,y,w,x);m.anim=null;r()});m.anim.animate()}function k(e,o,r,s,u){var m=this.config.steps;
o=this.length;var v=r?o-1:0,t=(v+1)*m;for(m=v*m;m<t;m++){e[m].style.position=h;e[m].style[s]=(r?"-":b)+u*o+a}return r?u:-u*o}function n(e,o,r,s,u){var m=this.config.steps;o=this.length;var v=r?o-1:0,t=(v+1)*m;for(m=v*m;m<t;m++){e[m].style.position=b;e[m].style[s]=b}this.content.style[s]=r?-u*(o-1)+a:b}var c=YAHOO.util,h="relative",i="left",q="top",a="px",b="",f="forward",l="backward",j="scrollx",p=d.Switchable;d.mix(p.Config,{circular:false});p.Plugins.push({name:"circular",init:function(e){e=e.config;
if(e.circular&&(e.effect===j||e.effect==="scrolly")){e.scrollType=e.effect;e.effect=g}}})});
KISSY.add("switchable-lazyload",function(d){var g=YAHOO.util.Dom,k="beforeSwitch",n="img-src",c="textarea-data",h={},i=d.Switchable,q=d.DataLazyload;h[n]="data-lazyload-src-custom";h[c]="ks-datalazyload-custom";d.mix(i.Config,{lazyDataType:"",lazyDataFlag:""});i.Plugins.push({name:"autoplay",init:function(a){function b(e){var o=l.steps;e=e*o;q.loadCustomLazyData(a.panels.slice(e,e+o),j,p);f()&&a.unsubscribe(k,b)}function f(){var e,o,r;if(j===n){e=a.container.getElementsByTagName("img");o=0;for(r=
e.length;o<r;o++)if(e[o].getAttribute(p))return false}else if(j===c){e=a.container.getElementsByTagName("textarea");o=0;for(r=e.length;o<r;o++)if(g.hasClass(e[o],p))return false}return true}var l=a.config,j=l.lazyDataType,p=l.lazyDataFlag||h[j];!q||!j||!p||a.subscribe(k,b)}})});KISSY.add("tabs",function(d){function g(k,n){if(!(this instanceof g))return new g(k,n);g.superclass.constructor.call(this,k,n)}d.extend(g,d.Switchable);d.Tabs=g});
KISSY.add("slide",function(d){function g(n,c){if(!(this instanceof g))return new g(n,c);c=d.merge(k,c||{});g.superclass.constructor.call(this,n,c)}var k={autoplay:true,circular:true};d.extend(g,d.Switchable);d.Slide=g});KISSY.add("carousel",function(d){function g(n,c){if(!(this instanceof g))return new g(n,c);c=d.merge(k,c||{});g.superclass.constructor.call(this,n,c)}var k={circular:true};d.extend(g,d.Switchable);d.Carousel=g});
KISSY.add("album",function(d){function g(n,c){if(!(this instanceof g))return new g(n,c);c=d.merge(k,c||{});g.superclass.constructor.call(this,n,c)}var k={circular:true};d.extend(g,d.Switchable);d.Album=g});
