/*
Copyright 2010, KISSY UI Library v1.0.8
MIT Licensed
build: 881 Jul 19 23:46
*/
KISSY.add("switchable",function(c,l){function h(b,a){a=a||{};if(!("markupType"in a))if(a.panelCls)a.markupType=1;else if(a.panels)a.markupType=2;a=c.merge(h.Config,a);this.container=c.get(b);this.config=a;this.activeIndex=a.activeIndex;this._init()}var f=c.DOM,n=c.Event;h.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,
activeTriggerCls:"active",steps:1,viewSize:[]};h.Plugins=[];c.augment(h,c.EventTarget,{_init:function(){var b=this,a=b.config;b._parseMarkup();a.hasTriggers&&b._bindTriggers();c.each(h.Plugins,function(d){d.init&&d.init(b)})},_parseMarkup:function(){var b=this.container,a=this.config,d,g=[],e=[];switch(a.markupType){case 0:if(d=c.get("."+a.navCls,b))g=f.children(d);d=c.get("."+a.contentCls,b);e=f.children(d);break;case 1:g=c.query("."+a.triggerCls,b);e=c.query("."+a.panelCls,b);break;case 2:g=a.triggers;
e=a.panels;break}b=e.length;this.length=b/a.steps;if(a.hasTriggers&&b>0&&g.length===0)g=this._generateTriggersMarkup(this.length);this.triggers=c.makeArray(g);this.panels=c.makeArray(e);this.content=d||e[0].parentNode},_generateTriggersMarkup:function(b){var a=this.config,d=f.create("<ul>"),g,e;d.className=a.navCls;for(e=0;e<b;e++){g=f.create("<li>");if(e===this.activeIndex)g.className=a.activeTriggerCls;g.innerHTML=e+1;d.appendChild(g)}this.container.appendChild(d);return f.children(d)},_bindTriggers:function(){var b=
this,a=b.config,d=b.triggers,g,e,j=d.length;for(e=0;e<j;e++)(function(k){g=d[k];n.on(g,"click focus",function(){b._onFocusTrigger(k)});if(a.triggerType==="mouse"){n.on(g,"mouseenter",function(){b._onMouseEnterTrigger(k)});n.on(g,"mouseleave",function(){b._onMouseLeaveTrigger(k)})}})(e)},_onFocusTrigger:function(b){if(this.activeIndex!==b){this._cancelSwitchTimer();this.switchTo(b)}},_onMouseEnterTrigger:function(b){var a=this;if(a.activeIndex!==b)a.switchTimer=c.later(function(){a.switchTo(b)},a.config.delay*
1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=l}},switchTo:function(b,a){var d=this.config,g=this.triggers,e=this.panels,j=this.activeIndex,k=d.steps,p=j*k,s=b*k;if(b===j)return this;if(this.fire("beforeSwitch",{toIndex:b})===false)return this;if(d.hasTriggers)this._switchTrigger(j>-1?g[j]:null,g[b]);if(a===l)a=b>j?"forward":"backward";this._switchView(e.slice(p,p+k),e.slice(s,s+k),b,a);
this.activeIndex=b;return this},_switchTrigger:function(b,a){var d=this.config.activeTriggerCls;b&&f.removeClass(b,d);f.addClass(a,d)},_switchView:function(b,a){f.css(b,"display","none");f.css(a,"display","block");this.fire("switch")},prev:function(){var b=this.activeIndex;this.switchTo(b>0?b-1:this.length-1,"backward")},next:function(){var b=this.activeIndex;this.switchTo(b<this.length-1?b+1:0,"forward")}});c.Switchable=h});
KISSY.add("switchable-autoplay",function(c){var l=c.Event,h=c.Switchable;c.mix(h.Config,{autoplay:false,interval:5,pauseOnHover:true});h.Plugins.push({name:"autoplay",init:function(f){var n=f.config;if(n.autoplay){if(n.pauseOnHover){l.on(f.container,"mouseenter",function(){f.paused=true});l.on(f.container,"mouseleave",function(){c.later(function(){f.paused=false},n.interval*1E3)})}f.autoplayTimer=c.later(function(){f.paused||f.switchTo(f.activeIndex<f.length-1?f.activeIndex+1:0)},n.interval*1E3,true)}}})});
KISSY.add("switchable-effect",function(c,l){var h=c.DOM,f=c.Anim,n=c.Switchable,b;c.mix(n.Config,{effect:"none",duration:0.5,easing:"easeNone"});n.Effects={none:function(a,d,g){h.css(a,"display","none");h.css(d,"display","block");g()},fade:function(a,d,g){a.length!==1&&c.error("fade effect only supports steps == 1.");var e=this,j=e.config,k=a[0],p=d[0];e.anim&&e.anim.stop();h.css(p,"opacity",1);e.anim=(new f(k,{opacity:0},j.duration,j.easing,function(){e.anim=l;h.css(p,"z-index",9);h.css(k,"z-index",
1);g()})).run()},scroll:function(a,d,g,e){var j=this;a=j.config;d=a.effect==="scrollx";var k={};k[d?"left":"top"]=-(j.viewSize[d?0:1]*e);j.anim&&j.anim.stop();j.anim=(new f(j.content,k,a.duration,a.easing,function(){j.anim=l;g()})).run()}};b=n.Effects;b.scrollx=b.scrolly=b.scroll;n.Plugins.push({name:"effect",init:function(a){var d=a.config,g=d.effect,e=a.panels,j=a.content,k=d.steps,p=a.activeIndex,s=e.length;a.viewSize=[d.viewSize[0]||e[0].offsetWidth*k,d.viewSize[1]||e[0].offsetHeight*k];if(g!==
"none"){c.each(e,function(r){h.css(r,"display","block")});switch(g){case "scrollx":case "scrolly":h.css(j,"position","absolute");h.css(j.parentNode,"position","relative");if(g==="scrollx"){h.css(e,"float","left");h.width(j,a.viewSize[0]*(s/k))}break;case "fade":var i=p*k,o=i+k-1,q;c.each(e,function(r,t){q=t>=i&&t<=o;h.css(r,{opacity:q?1:0,position:"absolute",zIndex:q?9:1})});break}}}});c.augment(n,{_switchView:function(a,d,g,e){var j=this,k=j.config.effect;(c.isFunction(k)?k:b[k]).call(j,a,d,function(){j.fire("switch")},
g,e)}})});
KISSY.add("switchable-circular",function(c,l){function h(i,o,q,r,t){var m=this;i=m.config;o=m.length;var v=m.activeIndex,u=i.scrollType===p,w=u?d:g,x=m.viewSize[u?0:1];u=-x*r;var z={},A,y=t===k;if(A=y&&v===0&&r===o-1||t===j&&v===o-1&&r===0)u=f.call(m,m.panels,r,y,w,x);z[w]=u;m.anim&&m.anim.stop();m.anim=(new c.Anim(m.content,z,i.duration,i.easing,function(){A&&n.call(m,m.panels,r,y,w,x);m.anim=l;q()})).run()}function f(i,o,q,r,t){var m=this.config.steps;o=this.length;var v=q?o-1:0,u=(v+1)*m;for(m=
v*m;m<u;m++){DOM.css(i[m],b,a);DOM.css(i[m],r,(q?-1:1)*t*o)}return q?t:-t*o}function n(i,o,q,r,t){var m=this.config.steps;o=this.length;var v=q?o-1:0,u=(v+1)*m;for(m=v*m;m<u;m++){DOM.css(i[m],b,e);DOM.css(i[m],r,e)}DOM.css(this.content,r,q?-t*(o-1):e)}var b="position",a="relative",d="left",g="top",e="",j="forward",k="backward",p="scrollx",s=c.Switchable;c.mix(s.Config,{circular:false});s.Plugins.push({name:"circular",init:function(i){i=i.config;if(i.circular&&(i.effect===p||i.effect==="scrolly")){i.scrollType=
i.effect;i.effect=h}}})});
KISSY.add("switchable-lazyload",function(c){var l=c.DOM,h="beforeSwitch",f="img-src",n="textarea-data",b={},a=c.Switchable;b[f]="data-lazyload-src-custom";b[n]="ks-datalazyload-custom";c.mix(a.Config,{lazyDataType:"",lazyDataFlag:""});a.Plugins.push({name:"lazyload",init:function(d){function g(i){var o=k.steps;i=i.toIndex*o;j.loadCustomLazyData(d.panels.slice(i,i+o),p,s);e()&&d.detach(h,g)}function e(){var i,o,q;if(i=p===f?"img":p===n?"textarea":""){i=c.query(i,d.container);o=0;for(q=i.length;o<q;o++)if(l.attr(i[o],
s))return false}return true}var j=c.DataLazyload,k=d.config,p=k.lazyDataType,s=k.lazyDataFlag||b[p];!j||!p||!s||d.on(h,g)}})});KISSY.add("tabs",function(c){function l(h,f){if(!(this instanceof l))return new l(h,f);l.superclass.constructor.call(this,h,f)}c.extend(l,c.Switchable);c.Tabs=l});KISSY.add("slide",function(c){function l(f,n){if(!(this instanceof l))return new l(f,n);l.superclass.constructor.call(this,f,c.merge(h,n))}var h={autoplay:true,circular:true};c.extend(l,c.Switchable);c.Slide=l});
KISSY.add("carousel",function(c){function l(f,n){if(!(this instanceof l))return new l(f,n);l.superclass.constructor.call(this,f,c.merge(h,n))}var h={circular:true};c.extend(l,c.Switchable);c.Carousel=l});
