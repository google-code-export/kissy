/*
Copyright 2010, KISSY UI Library v1.0.8
MIT Licensed
build: 882 Jul 20 10:48
*/
KISSY.add("switchable",function(c,m){function i(a,b){b=b||{};if(!("markupType"in b))if(b.panelCls)b.markupType=1;else if(b.panels)b.markupType=2;b=c.merge(i.Config,b);this.container=c.get(a);this.config=b;this.activeIndex=b.activeIndex;this._init()}var j=c.DOM,g=c.Event;i.Config={markupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,
activeTriggerCls:"active",steps:1,viewSize:[]};i.Plugins=[];c.augment(i,c.EventTarget,{_init:function(){var a=this,b=a.config;if(a.fire("beforeInit")!==false){a._parseMarkup();b.hasTriggers&&a._bindTriggers();c.each(i.Plugins,function(d){d.init&&d.init(a)});a.fire("init")}},_parseMarkup:function(){var a=this.container,b=this.config,d,h=[],f=[];switch(b.markupType){case 0:if(d=c.get("."+b.navCls,a))h=j.children(d);d=c.get("."+b.contentCls,a);f=j.children(d);break;case 1:h=c.query("."+b.triggerCls,
a);f=c.query("."+b.panelCls,a);break;case 2:h=b.triggers;f=b.panels;break}a=f.length;this.length=a/b.steps;if(b.hasTriggers&&a>0&&h.length===0)h=this._generateTriggersMarkup(this.length);this.triggers=c.makeArray(h);this.panels=c.makeArray(f);this.content=d||f[0].parentNode},_generateTriggersMarkup:function(a){var b=this.config,d=j.create("<ul>"),h,f;d.className=b.navCls;for(f=0;f<a;f++){h=j.create("<li>");if(f===this.activeIndex)h.className=b.activeTriggerCls;h.innerHTML=f+1;d.appendChild(h)}this.container.appendChild(d);
return j.children(d)},_bindTriggers:function(){var a=this,b=a.config,d=a.triggers,h,f,e=d.length;for(f=0;f<e;f++)(function(k){h=d[k];g.on(h,"click focus",function(){a._onFocusTrigger(k)});if(b.triggerType==="mouse"){g.on(h,"mouseenter",function(){a._onMouseEnterTrigger(k)});g.on(h,"mouseleave",function(){a._onMouseLeaveTrigger(k)})}})(f)},_onFocusTrigger:function(a){if(this.activeIndex!==a){this._cancelSwitchTimer();this.switchTo(a)}},_onMouseEnterTrigger:function(a){var b=this;if(b.activeIndex!==
a)b.switchTimer=c.later(function(){b.switchTo(a)},b.config.delay*1E3)},_onMouseLeaveTrigger:function(){this._cancelSwitchTimer()},_cancelSwitchTimer:function(){if(this.switchTimer){this.switchTimer.cancel();this.switchTimer=m}},switchTo:function(a,b){var d=this.config,h=this.triggers,f=this.panels,e=this.activeIndex,k=d.steps,n=e*k,q=a*k;if(a===e)return this;if(this.fire("beforeSwitch",{toIndex:a})===false)return this;if(d.hasTriggers)this._switchTrigger(e>-1?h[e]:null,h[a]);if(b===m)b=a>e?"forward":
"backward";this._switchView(f.slice(n,n+k),f.slice(q,q+k),a,b);this.activeIndex=a;return this},_switchTrigger:function(a,b){var d=this.config.activeTriggerCls;a&&j.removeClass(a,d);j.addClass(b,d)},_switchView:function(a,b,d){j.css(a,"display","none");j.css(b,"display","block");this._fireOnSwitch(d)},_fireOnSwitch:function(a){this.fire("switch",{currentIndex:a})},prev:function(){var a=this.activeIndex;this.switchTo(a>0?a-1:this.length-1,"backward")},next:function(){var a=this.activeIndex;this.switchTo(a<
this.length-1?a+1:0,"forward")}});c.Switchable=i});
KISSY.add("switchable-autoplay",function(c){var m=c.Event,i=c.Switchable;c.mix(i.Config,{autoplay:false,interval:5,pauseOnHover:true});i.Plugins.push({name:"autoplay",init:function(j){var g=j.config;if(g.autoplay){if(g.pauseOnHover){m.on(j.container,"mouseenter",function(){j.paused=true});m.on(j.container,"mouseleave",function(){c.later(function(){j.paused=false},g.interval*1E3)})}j.autoplayTimer=c.later(function(){j.paused||j.switchTo(j.activeIndex<j.length-1?j.activeIndex+1:0)},g.interval*1E3,true)}}})});
KISSY.add("switchable-effect",function(c,m){var i=c.DOM,j=c.Anim,g=c.Switchable,a;c.mix(g.Config,{effect:"none",duration:0.5,easing:"easeNone"});g.Effects={none:function(b,d,h){i.css(b,"display","none");i.css(d,"display","block");h()},fade:function(b,d,h){b.length!==1&&c.error("fade effect only supports steps == 1.");var f=this,e=f.config,k=b[0],n=d[0];f.anim&&f.anim.stop();i.css(n,"opacity",1);f.anim=(new j(k,{opacity:0},e.duration,e.easing,function(){f.anim=m;i.css(n,"z-index",9);i.css(k,"z-index",
1);h()})).run()},scroll:function(b,d,h,f){var e=this;b=e.config;d=b.effect==="scrollx";var k={};k[d?"left":"top"]=-(e.viewSize[d?0:1]*f);e.anim&&e.anim.stop();e.anim=(new j(e.content,k,b.duration,b.easing,function(){e.anim=m;h()})).run()}};a=g.Effects;a.scrollx=a.scrolly=a.scroll;g.Plugins.push({name:"effect",init:function(b){var d=b.config,h=d.effect,f=b.panels,e=b.content,k=d.steps,n=b.activeIndex,q=f.length;b.viewSize=[d.viewSize[0]||f[0].offsetWidth*k,d.viewSize[1]||f[0].offsetHeight*k];if(h!==
"none"){c.each(f,function(s){i.css(s,"display","block")});switch(h){case "scrollx":case "scrolly":i.css(e,"position","absolute");i.css(e.parentNode,"position","relative");if(h==="scrollx"){i.css(f,"float","left");i.width(e,b.viewSize[0]*(q/k))}break;case "fade":var l=n*k,p=l+k-1,r;c.each(f,function(s,t){r=t>=l&&t<=p;i.css(s,{opacity:r?1:0,position:"absolute",zIndex:r?9:1})});break}}}});c.augment(g,{_switchView:function(b,d,h,f){var e=this,k=e.config.effect;(c.isFunction(k)?k:a[k]).call(e,b,d,function(){e._fireOnSwitch()},
h,f)}})});
KISSY.add("switchable-circular",function(c,m){function i(l,p,r,s,t){var o=this;l=o.config;p=o.length;var v=o.activeIndex,u=l.scrollType===n,w=u?d:h,x=o.viewSize[u?0:1];u=-x*s;var z={},A,y=t===k;if(A=y&&v===0&&s===p-1||t===e&&v===p-1&&s===0)u=j.call(o,o.panels,s,y,w,x);z[w]=u;o.anim&&o.anim.stop();o.anim=(new c.Anim(o.content,z,l.duration,l.easing,function(){A&&g.call(o,o.panels,s,y,w,x);o.anim=m;r()})).run()}function j(l,p,r,s,t){var o=this.config.steps;p=this.length;var v=r?p-1:0,u=(v+1)*o;for(o=
v*o;o<u;o++){DOM.css(l[o],a,b);DOM.css(l[o],s,(r?-1:1)*t*p)}return r?t:-t*p}function g(l,p,r,s,t){var o=this.config.steps;p=this.length;var v=r?p-1:0,u=(v+1)*o;for(o=v*o;o<u;o++){DOM.css(l[o],a,f);DOM.css(l[o],s,f)}DOM.css(this.content,s,r?-t*(p-1):f)}var a="position",b="relative",d="left",h="top",f="",e="forward",k="backward",n="scrollx",q=c.Switchable;c.mix(q.Config,{circular:false});q.Plugins.push({name:"circular",init:function(l){l=l.config;if(l.circular&&(l.effect===n||l.effect==="scrolly")){l.scrollType=
l.effect;l.effect=i}}})});
KISSY.add("switchable-lazyload",function(c){var m=c.DOM,i="beforeSwitch",j="img-src",g="textarea-data",a={},b=c.Switchable;a[j]="data-lazyload-src-custom";a[g]="ks-datalazyload-custom";c.mix(b.Config,{lazyDataType:"",lazyDataFlag:""});b.Plugins.push({name:"lazyload",init:function(d){function h(l){var p=k.steps;l=l.toIndex*p;e.loadCustomLazyData(d.panels.slice(l,l+p),n,q);f()&&d.detach(i,h)}function f(){var l,p,r;if(l=n===j?"img":n===g?"textarea":""){l=c.query(l,d.container);p=0;for(r=l.length;p<r;p++)if(m.attr(l[p],
q))return false}return true}var e=c.DataLazyload,k=d.config,n=k.lazyDataType,q=k.lazyDataFlag||a[n];!e||!n||!q||d.on(i,h)}})});KISSY.add("tabs",function(c){function m(i,j){if(!(this instanceof m))return new m(i,j);m.superclass.constructor.call(this,i,j)}c.extend(m,c.Switchable);c.Tabs=m});KISSY.add("slide",function(c){function m(j,g){if(!(this instanceof m))return new m(j,g);m.superclass.constructor.call(this,j,c.merge(i,g))}var i={autoplay:true,circular:true};c.extend(m,c.Switchable);c.Slide=m});
KISSY.add("carousel",function(c,m){function i(e,k){var n=this;if(!(n instanceof i))return new i(e,k);n.on("init",function(){j(n)});i.superclass.constructor.call(n,e,c.merge(f,k))}function j(e){var k=e.config;c.each(["prev","next"],function(n){var q=e[n+"Btn"]=c.get(b+k[n+"BtnCls"],e.container);a.on(q,function(l){l.preventDefault();e[n]()})});e.on("switch",function(n){var q=n.currentIndex;n=k.disableBtnCls;q=q===0?e[d]:q===e.length-1?e[h]:m;g.removeClass([e[d],e[h]],n);q&&g.addClass(q,n)});a.on(e.panels,
"click focus",function(){e.fire("itemSelected",{item:this})})}var g=c.DOM,a=c.Event,b=".",d="prevBtn",h="nextBtn",f={circular:true,prevBtnCls:"ks-switchable-prev-btn",nextBtnCls:"ks-switchable-next-btn",disableBtnCls:"ks-switchable-disable-btn"};c.extend(i,c.Switchable);c.Carousel=i});
KISSY.add("accordion",function(c){function m(g,a){if(!(this instanceof m))return new m(g,a);a=c.merge(j,a||{});m.superclass.constructor.call(this,g,a)}var i=c.DOM,j={triggerType:"click",multiPanelExpandable:false};c.extend(m,c.Switchable);c.augment(m,{_onFocusTrigger:function(g){var a=this.config;if(!(this.activeIndex===g&&!a.multiPanelExpandable)){this.switchTimer&&this.switchTimer.cancel();this.switchTo(g)}},_onMouseEnterTrigger:function(g){var a=this;if(a.config.multiPanelExpandable||a.activeIndex!==
g)a.switchTimer=c.later(function(){a.switchTo(g)},a.config.delay*1E3)},switchTo:function(g,a){var b=this.config,d=this.triggers,h=this.panels;if(b.multiPanelExpandable){if(this.fire("beforeSwitch",{toIndex:g})===false)return this;a=b.activeTriggerCls;if(h[g].style.display=="none"){i.addClass(d[g],a);i.css(h[g],"display","block")}else{i.removeClass(d[g],a);i.css(h[g],"display","none")}this.fire("switch");this.activeIndex=g}else m.superclass.switchTo.call(this,g,a);return this}});c.Accordion=m});
