/*
Copyright 2010, KISSY UI Library v1.0.4
MIT Licensed
build: 477 Mar 10 17:59
*/
KISSY.add("switchable",function(g,j){function n(a,b){var c=this;b=b||{};if(!("mackupType"in b))if(b.panelCls)b.mackupType=1;else if(b.panels)b.mackupType=2;b=g.merge(n.Config,b);c.container=g.get(a);c.config=b;c.triggers=c.triggers||[];c.panels=c.panels||[];if(c.activeIndex===j)c.activeIndex=b.activeIndex;c._init()}var o=YAHOO.util,e=o.Dom,f=o.Event,h=YAHOO.lang,q=document;n.Config={mackupType:0,navCls:"ks-switchable-nav",contentCls:"ks-switchable-content",triggerCls:"ks-switchable-trigger",panelCls:"ks-switchable-panel",
triggers:[],panels:[],hasTriggers:true,triggerType:"mouse",delay:0.1,activeIndex:0,activeTriggerCls:"active",steps:1,viewSize:[]};n.Plugins=[];g.mix(n.prototype,{_init:function(){var a=this,b=a.config;a.panels.length===0&&a._parseMackup();a.createEvent("beforeSwitch");a.createEvent("onSwitch");b.hasTriggers&&a._bindTriggers();g.each(n.Plugins,function(c){c.init&&c.init(a)})},_parseMackup:function(){var a=this,b=a.container,c=a.config,l=c.hasTriggers,k,p=[],d=[];switch(c.mackupType){case 0:if(k=g.get("."+
c.navCls,b))p=e.getChildren(k);k=g.get("."+c.contentCls,b);d=e.getChildren(k);break;case 1:p=g.query("."+c.triggerCls,b);d=g.query("."+c.panelCls,b);break;case 2:p=c.triggers;d=c.panels;break}b=d.length;a.length=b/c.steps;if(l&&b>0&&p.length===0)p=a._generateTriggersMackup(a.length);if(l){c=0;for(l=p.length;c<l;c++)a.triggers.push(p[c])}for(c=0;c<b;c++)a.panels.push(d[c]);a.content=k||d[0].parentNode},_generateTriggersMackup:function(a){var b=this,c=b.config,l=q.createElement("UL"),k,p;l.className=
c.navCls;for(p=0;p<a;p++){k=q.createElement("LI");if(p===b.activeIndex)k.className=c.activeTriggerCls;k.innerHTML=p+1;l.appendChild(k)}b.container.appendChild(l);return e.getChildren(l)},_bindTriggers:function(){var a=this,b=a.config,c=a.triggers,l,k,p=c.length;for(k=0;k<p;k++)(function(d){l=c[d];f.on(l,"click",function(){a._onFocusTrigger(d)});f.on(l,"focus",function(){a._onFocusTrigger(d)});if(b.triggerType==="mouse"){f.on(l,"mouseenter",function(){a._onMouseEnterTrigger(d)});f.on(l,"mouseleave",
function(){a._onMouseLeaveTrigger(d)})}})(k)},_onFocusTrigger:function(a){var b=this;if(b.activeIndex!==a){b.switchTimer&&b.switchTimer.cancel();b.switchTo(a)}},_onMouseEnterTrigger:function(a){var b=this;if(b.activeIndex!==a)b.switchTimer=h.later(b.config.delay*1E3,b,function(){b.switchTo(a)})},_onMouseLeaveTrigger:function(){var a=this;a.switchTimer&&a.switchTimer.cancel()},switchTo:function(a,b){var c=this,l=c.config,k=c.triggers,p=c.panels,d=c.activeIndex,i=l.steps,r=d*i,s=a*i;if(a===d)return c;
if(!c.fireEvent("beforeSwitch",a))return c;if(l.hasTriggers)c._switchTrigger(d>-1?k[d]:null,k[a]);if(b===j)b=a>d?"forward":"forward";c._switchView(p.slice(r,r+i),p.slice(s,s+i),a,b);c.activeIndex=a;return c},_switchTrigger:function(a,b){var c=this.config.activeTriggerCls;a&&e.removeClass(a,c);e.addClass(b,c)},_switchView:function(a,b,c){e.setStyle(a,"display","none");e.setStyle(b,"display","block");this.fireEvent("onSwitch",c)},prev:function(){var a=this,b=a.activeIndex;a.switchTo(b>0?b-1:a.length-
1,"backward")},next:function(){var a=this,b=a.activeIndex;a.switchTo(b<a.length-1?b+1:0,"forward")}});g.augment(n,o.EventProvider);g.Switchable=n});
KISSY.add("switchable-autoplay",function(g){var j=YAHOO.util.Event,n=YAHOO.lang,o=g.Switchable;g.mix(o.Config,{autoplay:false,interval:5,pauseOnHover:true});o.Plugins.push({name:"autoplay",init:function(e){var f=e.config;if(f.autoplay){if(f.pauseOnHover){j.on(e.container,"mouseenter",function(){e.paused=true});j.on(e.container,"mouseleave",function(){setTimeout(function(){e.paused=false},f.interval*1E3)})}e.autoplayTimer=n.later(f.interval*1E3,e,function(){e.paused||e.switchTo(e.activeIndex<e.length-
1?e.activeIndex+1:0)},null,true)}}})});
KISSY.add("switchable-effect",function(g){var j=YAHOO.util,n=j.Dom,o=g.Switchable,e;g.mix(o.Config,{effect:"none",duration:0.5,easing:j.Easing.easeNone});o.Effects={none:function(f,h,q){n.setStyle(f,"display","none");n.setStyle(h,"display","block");q()},fade:function(f,h,q){if(f.length!==1)throw new Error("fade effect only supports steps == 1.");var a=this,b=a.config,c=f[0],l=h[0];a.anim&&a.anim.stop();n.setStyle(l,"opacity",1);a.anim=new j.Anim(c,{opacity:{to:0}},b.duration,b.easing);a.anim.onComplete.subscribe(function(){a.anim=
null;n.setStyle(l,"z-index",9);n.setStyle(c,"z-index",1);q()});a.anim.animate()},scroll:function(f,h,q,a){var b=this;f=b.config;h=f.effect==="scrollx";var c={};c[h?"left":"top"]={to:-(b.viewSize[h?0:1]*a)};b.anim&&b.anim.stop();b.anim=new j.Anim(b.content,c,f.duration,f.easing);b.anim.onComplete.subscribe(function(){b.anim=null;q()});b.anim.animate()}};e=o.Effects;e.scrollx=e.scrolly=e.scroll;o.Plugins.push({name:"effect",init:function(f){var h=f.config,q=h.effect,a=f.panels,b=h.steps,c=f.activeIndex*
b,l=c+b-1,k=a.length;f.viewSize=[h.viewSize[0]||a[0].offsetWidth*b,h.viewSize[0]||a[0].offsetHeight*b];if(q!=="none"){for(h=0;h<k;h++)a[h].style.display="block";switch(q){case "scrollx":case "scrolly":f.content.style.position="absolute";f.content.parentNode.style.position="relative";if(q==="scrollx"){n.setStyle(a,"float","left");f.content.style.width=f.viewSize[0]*(k/b)+"px"}break;case "fade":for(h=0;h<k;h++){n.setStyle(a[h],"opacity",h>=c&&h<=l?1:0);a[h].style.position="absolute";a[h].style.zIndex=
h>=c&&h<=l?9:1}break}}}});g.mix(o.prototype,{_switchView:function(f,h,q,a){var b=this,c=b.config.effect;(typeof c==="function"?c:e[c]).call(b,f,h,function(){b.fireEvent("onSwitch",q)},q,a)}})});
KISSY.add("switchable-circular",function(g){function j(d,i,r,s,u){var m=this;d=m.config;i=m.length;var v=m.activeIndex,t=d.scrollType===k,w=t?h:q,x=m.viewSize[t?0:1];t=-x*s;var z={},A,y=u===l;if(A=y&&v===0&&s===i-1||u===c&&v===i-1&&s===0)t=n.call(m,m.panels,s,y,w,x);z[w]={to:t};m.anim&&m.anim.stop();m.anim=new e.Anim(m.content,z,d.duration,d.easing);m.anim.onComplete.subscribe(function(){A&&o.call(m,m.panels,s,y,w,x);m.anim=null;r()});m.anim.animate()}function n(d,i,r,s,u){var m=this;i=m.config.steps;
m=m.length;var v=r?m-1:0,t=(v+1)*i;for(i=v*i;i<t;i++){d[i].style.position=f;d[i].style[s]=(r?"-":b)+u*m+a}return r?u:-u*m}function o(d,i,r,s,u){i=this;var m=i.config.steps,v=i.length,t=r?v-1:0,w=(t+1)*m;for(m=t*m;m<w;m++){d[m].style.position=b;d[m].style[s]=b}i.content.style[s]=r?-u*(v-1)+a:b}var e=YAHOO.util,f="relative",h="left",q="top",a="px",b="",c="forward",l="backward",k="scrollx",p=g.Switchable;g.mix(p.Config,{circular:false});p.Plugins.push({name:"circular",init:function(d){d=d.config;if(d.circular&&
(d.effect===k||d.effect==="scrolly")){d.scrollType=d.effect;d.effect=j}}})});
KISSY.add("switchable-lazyload",function(g){var j=YAHOO.util.Dom,n="beforeSwitch",o="img-src",e="textarea-data",f={},h=g.Switchable,q=g.DataLazyload;f[o]="data-lazyload-src-custom";f[e]="ks-datalazyload-custom";g.mix(h.Config,{lazyDataType:"",lazyDataFlag:""});h.Plugins.push({name:"autoplay",init:function(a){function b(d){var i=l.steps;d=d*i;q.loadCustomLazyData(a.panels.slice(d,d+i),k,p);c()&&a.unsubscribe(n,b)}function c(){var d,i,r;if(k===o){d=a.container.getElementsByTagName("img");i=0;for(r=
d.length;i<r;i++)if(d[i].getAttribute(p))return false}else if(k===e){d=a.container.getElementsByTagName("textarea");i=0;for(r=d.length;i<r;i++)if(j.hasClass(d[i],p))return false}return true}var l=a.config,k=l.lazyDataType,p=l.lazyDataFlag||f[k];!q||!k||!p||a.subscribe(n,b)}})});KISSY.add("tabs",function(g){function j(n,o){var e=this;if(!(e instanceof j))return new j(n,o);j.superclass.constructor.call(e,n,o)}g.extend(j,g.Switchable);g.Tabs=j});
KISSY.add("slide",function(g){function j(o,e){var f=this;if(!(f instanceof j))return new j(o,e);e=g.merge(n,e||{});j.superclass.constructor.call(f,o,e)}var n={autoplay:true,circular:true};g.extend(j,g.Switchable);g.Slide=j});KISSY.add("carousel",function(g){function j(o,e){var f=this;if(!(f instanceof j))return new j(o,e);e=g.merge(n,e||{});j.superclass.constructor.call(f,o,e)}var n={circular:true};g.extend(j,g.Switchable);g.Carousel=j});
