/*
Copyright (c) 2009, Kissy UI Library. All rights reserved.
MIT Licensed.
http://kissy.googlecode.com/

Date: 2009-12-25 00:21:15
Revision: 351
*/
KISSY.add("slideview",function(i){var f=YAHOO.util,e=f.Dom,r=f.Event,h=YAHOO.lang,q="block",k="none",n="opacity",g="z-index",o="relative",p="absolute",d="scrollx",b="scrolly",c="fade",a="ks-slideview-",l={navCls:a+"nav",contentCls:a+"content",triggerType:"mouse",triggerDelay:0.1,autoPlay:true,autoPlayInterval:5,pauseOnMouseOver:true,effectType:k,animDuration:0.5,animEasing:f.Easing.easeNone,activeIndex:0,activeTriggerCls:a+"trigger-active",panelSize:[]},m={none:function(s,t,u){s.style.display=k;t.style.display=q;u()},fade:function(u,v,w){var t=this,s=t.config;if(t.anim){t.anim.stop()}e.setStyle(v,n,1);t.anim=new f.Anim(u,{opacity:{to:0}},s.animDuration,s.animEasing);t.anim.onComplete.subscribe(function(){t.anim=null;e.setStyle(v,g,9);e.setStyle(u,g,1);w()});t.anim.animate()},scroll:function(s,x,y,u){var z=this,v=z.config,A=v.effectType===d,w=z.panelSize[A?0:1]*u,t={};t[A?"left":"top"]={to:-w};if(z.anim){z.anim.stop()}z.anim=new f.Anim(z.content,t,v.animDuration,v.animEasing);z.anim.onComplete.subscribe(function(){z.anim=null;y()});z.anim.animate()}};m[d]=m[b]=m.scroll;function j(s,u){var t=this;if(!(t instanceof arguments.callee)){return new arguments.callee(s,u)}t.container=e.get(s);if(u.effectType===d||u.effectType===b){l.animDuration=0.8;l.animEasing=f.Easing.easeOutStrong}t.config=i.merge(l,u||{});t.triggers=[];t.panels=[];t.panelSize=[];t.activeIndex=t.config.activeIndex;t._init()}i.mix(j.prototype,{_init:function(){var t=this,s=t.config;t._parseMackup();t._initStyle();t._initTriggers();if(s.autoPlay){t._initAutoPlay()}},_parseMackup:function(){var D=this,t=D.container,y=D.config,s,z,B=[],A=[],u,v,w,x,C=e.getElementsByClassName;z=C(y.contentCls,"*",t)[0];A=e.getChildren(z);s=C(y.navCls,"*",t)[0]||D._generateNavMackup(A.length);B=e.getChildren(s);u=B.length;v=A.length;for(w=0,x=u>v?v:u;w<x;w++){D.triggers.push(B[w]);D.panels.push(A[w])}D.nav=s;D.content=z},_generateNavMackup:function(t){var v=this,u=v.config,x=document.createElement("UL"),s,w;x.className=u.navCls;for(w=0;w<t;w++){s=document.createElement("LI");if(w===v.activeIndex){s.className=u.activeTriggerCls}s.innerHTML=w+1;x.appendChild(s)}v.container.appendChild(x);return x},_initStyle:function(){var v=this,u=v.config,y=u.effectType,w=v.panels,x,t=v.triggers.length,s=v.activeIndex;v.panelSize[0]=u.panelSize[0]||w[0].offsetWidth;v.panelSize[1]=u.panelSize[0]||w[0].offsetHeight;if(y===k){for(x=0;x<t;x++){w[x].style.display=x===s?q:k}}else{for(x=0;x<t;x++){w[x].style.display=q}switch(y){case d:case b:v.container.style.position=o;v.content.style.position=p;if(y===d){e.setStyle(w,"float","left");this.content.style.width=v.panelSize[0]*t+"px"}break;case c:for(x=0;x<t;x++){e.setStyle(w[x],n,x===v.activeIndex?1:0);w[x].style.position=p;w[x].style.zIndex=x===v.activeIndex?9:1}break}}},_initAutoPlay:function(){var u=this,t=u.config,s=u.panels.length-1;if(t.pauseOnMouseOver){r.on([u.content,u.nav],"mouseenter",function(){u.paused=true});r.on([u.content,u.nav],"mouseleave",function(){u.paused=false})}u.autoPlayTimer=h.later(t.autoPlayInterval*1000,this,function(){if(u.paused){return}u.switchTo(u.activeIndex<s?u.activeIndex+1:0)},null,true)},_switchContent:function(u,v,t){var s=this;m[s.config.effectType].call(s,u,v,function(){s.fireEvent("onSwitch",t)},t)}});i.augment(j,i.Triggerable,false);i.SlideView=j});
