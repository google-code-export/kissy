/*
Copyright (c) 2009, Kissy UI Library. All rights reserved.
MIT Licensed.
http://kissy.googlecode.com/

Date: 2009-12-23 17:51:09
Revision: 338
*/
KISSY.add("slideview",function(i){var c=YAHOO.util,k=c.Dom,o=c.Event,m=YAHOO.lang,a="block",n="none",p="opacity",e="z-index",l="relative",d="absolute",h="ks-slideview-",f={NONE:"none",SCROLLX:"scrollx",SCROLLY:"scrolly",FADE:"fade"},g={navCls:h+"nav",contentCls:h+"content",triggerType:"mouse",triggerDelay:0.1,autoPlay:true,autoPlayInterval:5,pauseOnMouseOver:true,effectType:f.NONE,animDuration:0.5,animEasing:c.Easing&&c.Easing.easeNone,activeIndex:0,activeTriggerCls:h+"trigger-active",panelSize:[]},b={none:function(q,r){q.style.display=n;r.style.display=a},fade:function(s,t){var r=this,q=r.config;k.setStyle(t,e,1);k.setStyle(s,e,9);k.setStyle(t,p,1);r.anim=new c.Anim(s,{opacity:{to:0}},q.animDuration,q.animEasing);r.anim.onComplete.subscribe(function(){r.anim=null;k.setStyle(t,e,9);k.setStyle(s,e,1)});r.anim.animate()},scroll:function(u,v,t,w){var s=this,q=s.config,x=s.panelSize[w?0:1]*t,r={};r[w?"left":"top"]={to:-x};s.anim=new c.Anim(s.content,r,q.animDuration,q.animEasing);s.anim.onComplete.subscribe(function(){s.anim=null});s.anim.animate()}};b[f.SCROLLX]=b[f.SCROLLY]=b.scroll;function j(q,r){if(!(this instanceof arguments.callee)){return new arguments.callee(q,r)}this.container=k.get(q);if(r.effectType===f.SCROLLX||r.effectType===f.SCROLLY){g.animDuration=0.8;g.animEasing=c.Easing&&c.Easing.easeOutStrong}this.config=i.merge(g,r||{});this.triggers=[];this.panels=[];this.panelSize=[];this.activeIndex=this.config.activeIndex;this.autoPlayIsPaused=false;this._init()}i.augment(j,i.Triggerable);i.mix(j.prototype,{_init:function(){var q=this;q._parseMackup();q._initStyle();q._initTriggers();if(q.config.autoPlay){q._initAutoPlay()}},_parseMackup:function(){var B=this,r=B.container,w=B.config,q,x,z=[],y=[],s,t,u,v,A=k.getElementsByClassName;x=A(w.contentCls,"*",r)[0];y=k.getChildren(x);q=A(w.navCls,"*",r)[0]||B._generateNavMackup(y.length);z=k.getChildren(q);s=z.length;t=y.length;for(u=0,v=s>t?t:s;u<v;u++){B.triggers.push(z[u]);B.panels.push(y[u])}B.nav=q;B.content=x},_generateNavMackup:function(r){var t=this,s=t.config,v=document.createElement("UL"),q,u;v.className=s.navCls;for(u=0;u<r;u++){q=document.createElement("LI");if(u===t.activeIndex){q.className=s.activeTriggerCls}q.innerHTML=u+1;v.appendChild(q)}t.container.appendChild(v);return v},_initStyle:function(){var t=this,s=t.config,w=s.effectType,u=t.panels,v,r=t.triggers.length,q=t.activeIndex;t.panelSize[0]=s.panelSize[0]||u[0].offsetWidth;t.panelSize[1]=s.panelSize[0]||u[0].offsetHeight;if(w===f.NONE){for(v=0;v<r;v++){u[v].style.display=v===q?a:n}}else{for(v=0;v<r;v++){u[v].style.display=a}if(w===f.SCROLLX||w===f.SCROLLY){t.container.style.position=l;t.content.style.position=d;if(w===f.SCROLLX){k.setStyle(u,"float","left");this.content.style.width=t.panelSize[0]*r+"px"}}if(w===f.FADE){for(v=0;v<r;v++){k.setStyle(u[v],p,v===t.activeIndex?1:0);u[v].style.position=d;u[v].style.zIndex=v===t.activeIndex?9:1}}}},_initAutoPlay:function(){var s=this,r=s.config,q=s.panels.length-1;if(r.pauseOnMouseOver){o.on([s.content,s.nav],"mouseenter",function(){s.autoPlayIsPaused=true});o.on([s.content,s.nav],"mouseleave",function(){s.autoPlayIsPaused=false})}if(r.autoPlay){s.autoPlayTimer=m.later(r.autoPlayInterval*1000,this,function(){if(s.autoPlayIsPaused){return}s.switchTo(s.activeIndex<q?s.activeIndex+1:0)},null,true)}},_switchContent:function(t,v,s){var r=this,q=r.config,u=q.effectType;b[u].call(this,t,v,s,u===f.SCROLLX)}});i.SlideView=j});
