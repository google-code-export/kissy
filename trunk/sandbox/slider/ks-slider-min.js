KISSY.add("slider",function(r){var h=YAHOO.util,k=h.Dom,l=h.Event,d=YAHOO.lang,w={triggersClass:"triggers",currentClass:"current",eventType:"mouse",effect:"none",delay:5E3,speed:500,autoPlay:true,startAt:0,direction:"vertical"},s={none:function(){var a=this;a.scroller[a.direction.x?"scrollLeft":"scrollTop"]=a.next*a.switchSize},fade:function(){var a=this,c=a.config,b=a.panels,e=k.setStyle,g=b[a.current]||b[0],i=b[a.next]||b[b.length-1];if(!this._initFade){e(b,"position","absolute");e(b,"top",c.slideOffsetY||
0);e(b,"left",c.slideOffsetX||0);e(b,"z-index",1);e(b,"display","none");this.initFade=true}this._anim&&this._fading&&this._anim.stop();e(b,"display","none");e(g,"z-index",2);e(i,"z-index",1);e(i,"opacity",1);e([g,i],"display","");this._fading=true;this._anim=new YAHOO.util.Anim(g,{opacity:{from:1,to:0}},c.speed/1E3||0.5,c.easing||h.Easing.easeNone);this._anim.onComplete.subscribe(function(){e(g,"display","none");e([g,i],"z-index",1);this._fading=false},a,true);this._anim.animate()},scroll:function(){var a=
this,c=a.config,b={scroll:{to:[]}};b.scroll.to[a.direction.x?0:1]=a.next*a.switchSize;this._anim&&this._anim.stop();this._anim=new h.Scroll(this.scroller,b,c.speed/1E3||0.5,c.easing||h.Easing.easeOutStrong);this._anim.animate()}},t=function(a,c){this.container=k.get(a);this.config=d.merge(w,c||{});this._init()};r.mix(t.prototype,{_init:function(){var a=this.config,c=this.container,b,e={x:a.direction=="horizontal"||a.direction=="h",y:a.direction=="vertical"||a.direction=="v"},g=a.panels||d.merge([],
c.getElementsByTagName("li")),i=g.length,n=parseInt(this.config.switchSize,10);n||(n=g[0][e.x?"clientWidth":"clientHeight"]);var q=a.scroller||g[0].parentNode,f=a.triggers;if(!f){f=document.createElement("ul");k.addClass(f,a.triggersClass);for(var m=0;m<i;){var u=document.createElement("li");u.innerHTML=++m;f.appendChild(u)}c.appendChild(f);f=d.merge([],f.getElementsByTagName("li"))}var o=d.isNumber(a.startAt)?a.startAt:0;b=d.isFunction(a.effect)?a.effect:d.isString(a.effect)&&d.isFunction(s[a.effect])?
s[a.effect]:b.none;this.effect=new h.CustomEvent("effect",this,false,h.CustomEvent.FLAT);this.effect.subscribe(b);if(d.isFunction(a.onSwitch)){this.onSwitchEvent=new h.CustomEvent("onSwitchEvent",this,false,h.CustomEvent.FLAT);this.onSwitchEvent.subscribe(a.onSwitch)}l.on(c,"mouseover",function(){this.sleep()},this,true);l.on(c,"mouseout",function(){a.autoPlay&&this.wakeup()},this,true);m=0;c=f.length;for(var j,v=YAHOO.env.ie;m<c;m++)(function(p){switch(a.eventType.toLowerCase()){case "mouse":l.on(f[p],
v?"mouseenter":"mouseover",function(){j&&j.cancel();j=d.later(200,this,function(){this.switchTo(p)})},this,true);l.on(f[p],v?"mouseleave":"mouseout",function(){j&&j.cancel();a.autoPlay&&this.wakeup()},this,true);break;default:l.on(f[p],"click",function(x){l.stopEvent(x);j&&j.cancel();j=d.later(50,this,function(){this.switchTo(p)})},this,true)}}).call(this,m);k.addClass(f[o],a.currentClass);q.scrollTop=n*o;q.scrollLeft=n*o;if(a.autoPlay&&i>1){this.pause=false;d.later(a.delay,this,function(){this.switchTo(o+
1)})}this.direction=e;this.panels=g;this.switchSize=n;this.scroller=q;this.triggers=f;this.current=o;this.total=i},switchTo:function(a){var c=this.config,b=this;if(!(b.pause&&!d.isNumber(a))){this.timer&&this.timer.cancel();this.next=d.isNumber(a)?a:b.current+1;if(this.next>=b.total)this.next=d.isNumber(c.startAt)?c.startAt:0;b.effect.fire();this.current=this.next;d.isObject(b.onSwitchEvent)&&b.onSwitchEvent.fire&&this.onSwitchEvent.fire();k.removeClass(b.triggers,c.currentClass);k.addClass(b.triggers[this.current],
c.currentClass);if(c.autoPlay)this.timer=d.later(c.delay,this,arguments.callee)}},sleep:function(){this.pause=true;this.timer&&this.timer.cancel()},wakeup:function(){this.timer&&this.timer.cancel();this.pause=false;this.timer=d.later(this.config.delay,this,function(){this.switchTo(this.current+1)})}});r.Slider=t});
